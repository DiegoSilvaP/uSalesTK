{% extends 'core/base.html' %}
{% load static %}
{% block title %}Iniciar sesión{% endblock %}
{% block content %}
<style>.errorlist{color:red;} label{display:none} </style>
<main role="main">

    <div class="container">
        <div class="row py-4">
            <div class="col-md-3" id="errorList">
                {% if messages %}
                {% for message in messages %}

                <div class="alert {% if message.tags %} alert-{{ message.tags }}{% endif %}">{{ message|safe }}</div>
                {% endfor %}
                {% endif %}

                {% if form.errors %}
                <div class="alert alert-error" style="display:none;">
                    <h4>Please fix the following errors</h4>
                    <ul>
                        {% for field in form %}
                        {% if field.errors %}
                        {% for error in field.errors %}
                        <li><a href="#id_{{ field.name }}" class="error">{{ error|escape }}</a></li>
                        {% endfor %}
                        {% endif %}
                        {% endfor %}
                    </ul>
                    {% if form.non_field_errors %}
                    {{ form.non_field_errors }}
                    {% endif %}
                </div>
                {% endif %}
            </div>
            <div class="col-md-6">
                <div class="card bg-primary text-white">
                    <div class="card-body">
                        <h3 class="card-title"><b>Iniciar sesión</b></h3>
                        
                                {% if 'register' in request.GET %}
                                  <p style="color:green;">Te has registrado satisfactoriamente, incia sesión para empezar.</p>
                                {% endif %}
                                <form action="" method="post">{% csrf_token %}
                                  
                                  {% if form.non_field_errors %}
                                    <p style="color:red">Usuario o contraseña incorrectos, prueba de nuevo.</p>
                                  {% endif %}
                                  <p>
                                    <input type="text" name="username" autofocus maxlength="254" required
                                      id="id_username" class="form-control" placeholder="Nombre de usuario"/>
                                  </p>
                                  <p>
                                    <input type="password" name="password" required
                                      id="id_password" class="form-control" placeholder="Contraseña"/>
                                  </p>
                                  <p><input type="submit" class="btn btn-secondary btn-block text-white" value="Acceder"></p>
                                </form>
                                <p><a class="link" href="{% url 'password_reset' %}">Olvidé mi contraseña</a>.</p>
                              
                        <a href="{% url 'signup' %}" class="btn btn-outline-secondary btn-block" >Crear cuenta</a>
                    </div>
                </div>
            </div>
            <div class="col-md-3"></div>
        </div>
    </div>
    <script>
        $(document).ready(function () {
            console.log("ready!");
            var ul = document.getElementById('errorList').lastElementChild.children[1];
            for (i = 0; i < ul.childElementCount; i++) {
                console.log(ul.children[i].textContent);
            }


            function showMessage() {
                if (ul.childElementCount > 0) {
                    $.growl.error({
                        message: "The kitten is cute!"
                    });
                }
            }
        });
    </script>
</main>
{% endblock %}